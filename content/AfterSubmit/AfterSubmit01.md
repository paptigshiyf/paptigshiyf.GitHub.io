---
title: "After Submit 01"
date: 2023-04-26T15:06:54+08:00
draft: true
summary: "我的第一篇文章发表后的感想\n\n
JACS2022：[MMLPS探索CuZn合金催化CO2/CO甲醇合成的反应机理](https://doi.org/10.1021/jacs.2c06044)"
---

折腾了这么久，总算先把文章投出去了。 

后面必然还有很多折腾的问题，但尚可小小开心一会儿。 

在此，把三年间的一些感想、经验整理成文，以飨来者。 

我个人的想法，必非最佳的解决方案，只是期许部分内容能有一些帮助。请有选择性地看待。 

最后，感谢刘老师的指导和帮助。 

2022年6月9日 

shiyf

*************
*************

## Coding

#### 文件不要超过1000行

* 文件太长，意味着这个文件一定是可以分割的

* 在一个长文件里，光是找一个函数都会非常痛苦（鼠标滚轮或者PageUp&Down），只能全靠搜索(ctrl+F或者:xx)

#### 函数不要超过200行

* 函数太长，意味着这个函数一定是可以分割的；或者一些代码段没有很好地复用

* 大函数出错不方便找问题，难以测试

* 大函数多半有复杂的逻辑嵌套，也会使得可读性下降、可维护性下降

* 有几段代码太屎山了，甚至我不想修改他们，只想推倒重写，我很后悔。

#### 命名(函数名/变量名/参数名/文件名)多费一些心思
* 一个正常的命名，应该能让人直接理解其功能和类型。
    * 这能帮助别人看懂代码
    * 这能帮助你自己一段时间之后，回忆起代码
    * 你遇到难以解决的问题时，别人更方便debug
* 避免使用意义不明的`aa`, `11`作为命名 
* 不要惧怕使用长的变量名，尤其是使用IDE的选手，因为现在的IDE普遍有代码自动补全插件。
* 多敲点字不费事儿；因为，**敲代码的时间**往往没有**读懂自己一个月前写了什么**的时间长

#### 命名(函数名/变量名/参数名/文件名)最好有统一的风格
* 要驼全驼，要蛇全蛇
* 驼里混`_`，或蛇里混大小写，或者半驼不驼，或者半蛇不蛇，会成为你一个月以后的噩梦
* > 我记得这个函数，但这里是`abctolat`还是`abcToLat`还是`Abc2Lat`还是`Abc2lat`还是`abc_lat`? （血压上升）

    > 我自己习惯的风格，大致如下，虽然我也没有很严格地遵守：
    > * 变量、参数：驼式命名，小写开头
    > * 函数、类：驼式命名，大写开头
    > * 静态变量：蛇形命名，全大写

#### 文档和测试

* 对大项目，给每个文件、每个功能建议写单元测试。
* 项目后期，有时不得不修改底层代码，但这些底层代码可能引起其他代码的问题。有测试，你会对这些改动更加自信。
* 不要吝啬写注释和文档。尤其是用IDE的选手，注释写中文都不要紧，有注释就比没有好。
* 对于一些大型项目，项目有1/3甚至更多的内容，是文档or测试，是很正常的

#### 验证原型还是五年计划？

* 实际上我们大部分为了发表而写的code，都只是写个prototype罢了。
    * 写proprotototype时设计的架构，未必是合理的。往往开发到后半程时，处处掣肘，非常难受
    * 不过，假使没有写过prototype：
        * 你不知道自己真实的需求
        * 你不知道怎样的架构是合理的，以及优秀的架构为何优秀
        * 你不知道会在什么奇怪的角落，遇到什么奇怪的问题
    * 实现基本的功能，说明自己的想法可行
    * 踩坑并寻找解决方案；下次看到坑会有心理准备

* 如果验证说明想法很好，是未来可以传5年的代码
    * 如果原有框架一团糟，设计好结构，重写一版程序
        * 在合适的时间点重构。相比之下，肯定是写文章和毕业要紧。 
    * 跑路前留好注释和文档，方便师弟师妹看懂
    * 事实上对于稍大的项目，强烈建议在项目伊始，就做好注释、文档，并使用规范统一的命名
    * 单元测试是个好概念，大家可以了解一下
    * 当然对于测试原型，

#### Debug 代价
* python脚本运行慢，其实不是大问题。但debug速度慢，是很难受的
* 比如debug的时候，改了两行代码，一次debug运行10分钟，遭不住的
* 这种情形下，建议：
    1. 优化代码，提升速度
    2. 制作快捷、独立的单元测试，而非直接运行main()
    3. 缓存部分数据，参见`pickle.dump`, `pickle.load`

#### 使用程序包
* 网上的程序包，没有文档的，建议直接ban了，别用
* 教程 > 示例 >> API Reference >> 代码
* 函数名 > 注释 > 源码 

## Plot

#### Matplotlib制图
* matplotlib的函数和参数很容易记不清楚，多查官方文档&Google，cheatsheet建议开着随时备查
* 画图的脚本，务必保证可读性，可修改性。因为每一张图片，都可能反复修改数十次。
* 一张图片，对应一个脚本；一类图片，对应一个目录。别把自己搞晕！
* 保存图片分辨率高一些，我习惯写`plt.save_fig("xxx.png", dpi=300)`
* 不要怕文件太大，那是投稿前再考虑的事

#### PPT制图
* 不要觉得ppt土。有时在ppt/photoshop里改一改，远远比用matplotlib实现更加简单
* 文字标注、箭头、框，建议用ppt实现。如果底图需要修改，其他元素位置不变，替换底图即可。

# Writing
* 我太过失败，不能给出什么建议。和初稿相比，刘老师几乎重写了一遍。
* 写作和修改的周期，不要像我这样拖得这么这么长。
* 动笔前想一想，需要画哪几张图，哪几张图值得放在正文。
* 所有图片放在一个ppt及文件夹中；所有脚本和绘图数据放在一个目录下。
* 建议初稿闭关一周速速写就
* 刘老师改完一稿以后，尽可能快地改好，回给刘老师。

# 其他的话
* **不要自闭，自闭没用**，遇到问题，找人帮忙才会比较高效。
* 找不到人帮忙，及时跟老板~~摆烂~~反映问题
* 不想做下去的课题，大不了就不做了，没事儿的
